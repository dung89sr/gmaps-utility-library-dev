<!DOCTYPE html "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>MapBridge: JavaScript Bridge to Google Maps Flash API</title>
        <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
        <script type="text/javascript" src="../src/mapbridge.js?key=ABQIAAAAGY8Xhrw1zw6Ia3dwUJVxKRTVDgad4Bvurg1SD7pTTN986X-SXRSKKVrETJW4qaW12HAV5dyl6wH7sw">
        </script>
        <script type="text/javascript">
            var map;
            var message = ["This", "is", "the", "secret", "message"];
            function init() {
              MapBridge.createMap(document.getElementById('map_canvas'), function(mp) {
                map = mp;
                map.addEventListener('mapevent_mapready', onMapReady);
              });
            }
            
            function onMapReady(e) {
              map.setCenter(new LatLng(37.4419, -122.1419), 13, MapType.NORMAL_MAP_TYPE());
              // Add 5 markers to the map at random locations
              // Note that we don't add the secret message to the marker's instance data
              var bounds = map.getLatLngBounds();
              var southWest = bounds.getSouthWest();
              var northEast = bounds.getNorthEast();
              var lngSpan = northEast.lng() - southWest.lng();
              var latSpan = northEast.lat() - southWest.lat();
              for (var i = 0; i < 5; i++) {
                var latlng = new LatLng(southWest.lat() + latSpan * Math.random(), southWest.lng() + lngSpan * Math.random());
                map.addOverlay(createMarker(latlng, i + 1));
              }
            }
            
            // Creates a marker at the given point
            // Clicking the marker will hide it
            function createMarker(latlng, number) {
              var marker = new Marker(latlng);
              marker.addEventListener('mapevent_click', function(e) {
                var myTitle = "<b>#" + number + "</b>";
                var myContent = message[number - 1];
                map.openInfoWindow(latlng, new InfoWindowOptions({
                  titleHTML: myTitle,
                  contentHTML: myContent
                }));
              });
              return marker;
            }
        </script>
    </head>
    <body onload="init()">
      <div>Click marker for secret message</div>
        <div id="map_canvas" style="width:100%;height:90%">
        </div>
    </body>
</html>
