<!DOCTYPE html "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Icon Simple</title>
        <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
        <script type="text/javascript" src="../src/mapbridge.js?key=ABQIAAAAGY8Xhrw1zw6Ia3dwUJVxKRTVDgad4Bvurg1SD7pTTN986X-SXRSKKVrETJW4qaW12HAV5dyl6wH7sw">
        </script>
        <script type="text/javascript">
            
            var map;
            
            function init() {
              MapBridge.createMap(document.getElementById('map_canvas'), function(mp) {
                map = mp;
                map.addEventListener('mapevent_mapready', onMapReady);
              });
            }
            
            function onMapReady(e) {
              map.setCenter(new LatLng(37.4419, -122.1419), 13, MapType.NORMAL_MAP_TYPE());
              var testLoader = map.create('flash.display.Loader');
              // image must come from same domain or have crossdomain.xml with a checkPolicyFile LoaderContext on remote server 
              // due to security restriction
              var urlRequest = map.create('flash.net.URLRequest', ['blue-dot.png']);
              testLoader.getContentLoaderInfo().addEventListener('complete', function(e) {
                var markerOptions = new MarkerOptions();
                markerOptions.setIcon(testLoader);
                markerOptions.setTooltip("Purple");
                markerOptions.setIconAlignment(MarkerOptions.ALIGN_HORIZONTAL_CENTER());
                markerOptions.setIconOffset(map.create('flash.geom.Point', [2, 2]));
                var marker = new Marker(map.getCenter(), markerOptions);
                map.addOverlay(marker);
              });
              testLoader.load(urlRequest);//, context);
            }
        </script>
    </head>
    <body onload="init()">
      <div>Load a PNG file as marker icon. File is subject to Flash domain security restriction.</div>
        <div id="map_canvas" style="width:100%;height:90%">
        </div>
    </body>
</html>
