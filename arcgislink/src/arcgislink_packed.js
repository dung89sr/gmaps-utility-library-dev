(function(){var S=function(a){var i,c,n;var b=a.split('.');n=window;for(i=0,c=b.length;i<c;i++){n[b[i]]=n[b[i]]||{};n=n[b[i]]}return n};var W=window;var G=S('google.maps');var bh,GLatLng,GMap2,GProjection,GTileLayer,GCopyrightCollection,GCopyright,GMapType,GMercatorProjection,G_MAP_OVERLAY_LAYER_PANE,GTileLayerOverlay,GInfoWindowTab,GLatLngBounds,GPolygon,GPolyline,GOverlay,GMarker,GPoint;GMap2=W.GMap2||G.Map2;bh=W.GEvent||G.Event;GProjection=W.GProjection||G.Projection;GTileLayer=W.GTileLayer||G.TileLayer;GCopyrightCollection=W.CopyrightCollection||G.CopyrightCollection;GCopyright=W.GCopyright||G.Copyright;GMapType=W.GMapType||G.MapType;GMercatorProjection=W.GMercatorProjection||G.MercatorProjection;G_MAP_OVERLAY_LAYER_PANE=W.G_MAP_OVERLAY_LAYER_PANE||G.MAP_OVERLAY_LAYER_PANE;GTileLayerOverlay=W.GTileLayerOverlay||G.TileLayerOverlay;GInfoWindowTab=W.GInfoWindowTab||G.InfoWindowTab;GLatLngBounds=W.GLatLngBounds||G.LatLngBounds;GPolygon=W.GPolygon||G.Polygon;GPolyline=W.GPolyline||G.Polyline;GOverlay=W.GOverlay||G.Overlay;GLatLng=W.GLatLng||G.LatLng;GPoint=W.GPoint||G.Point;GMarker=W.GMarker||G.Marker;var B=Math.PI/180;var I="esriGeometryPoint";var Q="esriGeometryPolyline";var bq="esriGeometryPolygon";var P="esriGeometryMultipoint";var bm="esriGeometryEnvelope";var bc="esriSpatialRelIntersects";var bb="esriSpatialRelContains";var ba="esriSpatialRelCrosses";var V="esriSpatialRelEnvelopeIntersects";var bg="esriSpatialRelIndexIntersects";var bl="esriSpatialRelOverlaps";var bn="esriSpatialRelTouches";var bd="esriSpatialRelWithin";var K=function(b,a,c){var i=(a==='')?0:b.indexOf(a);var e=c===''?b.length:b.indexOf(c,i+a.length);return b.substring(i+a.length,e)};var bk=function(o){return typeof o==='string'};var be=function(o){return o&&o.splice};var R=function(a,c,b){if(a&&c){var p;for(p in a){if(b||!(p in c)){c[p]=a[p]}}}return c};var L=function(a,b,c){if(bh){bh.trigger.apply(this,arguments)}};var bi=function(d,a,b){if(d&&a){if(d.indexOf&&!b){return d.indexOf(a)}else{for(var i=0,c=d.length;i<c;i++){if(d[i]===a||(b===true&&d[i].toString().toLowerCase()===a.toString().toLowerCase())){return i}}}}return-1};var O=function(a,b){for(var i=0,c=b.length;i<c;i++){a.push(b[i])}return a};var bj=function(a,b){var i=bi(a,b);if(i!==-1){a.splice(i,1)}};var w={};var bo=0;window.ags_jsonp=window.ags_jsonp||{};var bf=window.ags_jsonp;w.getJSON=function(i,g,b,d){var h='ags_jsonp'+(bo++)+'_'+Math.floor(Math.random()*1000000);var e=i+(i.indexOf('?')===-1?'?':'&');if(g){for(var x in g){if(g.hasOwnProperty(x)){e+=(x+'='+(escape?escape(g[x]):encodeURIComponent(g[x]))+'&')}}}var a=document.getElementsByTagName("head")[0];if(!a){throw new Error("document must have header tag");}var c=document.createElement("script");c.src=e+b+'=ags_jsonp.'+h;c.id=h;var f=function(){delete bf[h];a.removeChild(c);c=null;d.apply(null,arguments);L(w,'jsonpend',h)};bf[h]=f;a.appendChild(c);L(w,'jsonpstart',h);return h};w.getOptionValue=function(h,e,c,a,f){var b=R(h,{});if(e){b=R(e[c],b,true);if(a&&e.serviceOptions&&e.serviceOptions[a]){var d=e.serviceOptions[a];b=R(d[c],b,true);if(f&&d.layerOptions&&d.layerOptions[f]){var g=d.layerOptions[f];b=R(g[c],b,true)}}}return b};w.getAttributeValue=function(b,a){if(typeof b[a]!=='undefined'){return b[a]}for(var x in b){if(b.hasOwnProperty(x)){if(a.toLowerCase()===x.toString().toLowerCase()){return b[x]}}}return null};w.fromGeometryToJSON=function(e,d){function fromPointsToJSON(b){var a=[];for(var i=0,c=b.length;i<c;i++){a.push('['+b[i][0]+','+b[i][1]+']')}return'['+a.join(',')+']'}function fromLinesToJSON(b){var a=[];for(var i=0,c=b.length;i<c;i++){a.push(fromPointsToJSON(b[i]))}return'['+a.join(',')+']'}var f='{';if(e.x){f+='x:'+e.x+',y:'+e.y}else if(e.xmin){f+='xmin:'+e.xmin+',ymin:'+e.ymin+',xmax:'+e.xmax+',ymax:'+e.ymax}else if(e.points){f+='points:'+fromPointsToJSON(e.points)}else if(e.paths){f+='paths:'+fromLinesToJSON(e.paths)}else if(e.rings){f+='rings:'+fromLinesToJSON(e.rings)}if(d&&e.spatialReference){f+=',spatialReference:{wkid:'+e.spatialReference.wkid+'}'}f+='}';return f};w.groupResultsByLayer=function(b){var f={};var d,layerName;var e=b.results;if(e){for(var i=0,c=e.length;i<c;i++){d=e[i];layerName=d.layerName;if(!f[layerName]){var g={};for(var x in d.attributes){if(d.attributes.hasOwnProperty(x)){g[x]=x}}var a={displayFieldName:d.displayFieldName,spatialReference:d.geometry?d.geometry.spatialReference:null,geometryType:d.geometryType,fieldAliases:g,features:[]};f[layerName]=a}f[layerName].features.push(d)}}return f};w.getResultSetHtml=function(f,b){var e='<table class="ags-resultset">';var i,j,c,d;b=b||(f.features.length===1?'v':'h');var g=[];for(var x in f.fieldAliases){if(f.fieldAliases.hasOwnProperty(x)){g.push(x)}}if(b==='h'){e+='<tr>';for(i=0,c=g.length;i<c;i++){e+='<th class="ags-fieldname">'+f.fieldAliases[g[i]]+'</th>'}e+='</tr>'}for(i=0,c=f.features.length;i<c;i++){var a=f.features[i].attributes;if(b==='h'){e+='<tr>'}else if(i>0){e+='<tr><td colspan="2"><hr/></td></tr>'}for(j=0,d=g.length;j<d;j++){if(b==='h'){e+='<td class="ags-fieldvalue">'+a[g[j]]+'</td>'}else{e+='<tr><td class="ags-fieldname">'+f.fieldAliases[g[j]]+'</td><td class="ags-fieldvalue">'+a[g[j]]+'</td></tr>'}}if(b==='h'){e+='</tr>'}}e+='</table>';return e};var U={maxPolyPoints:1000,style:{icon:null,strokeColor:"#FF0000",strokeWeight:2,strokeOpacity:0.5,outlineColor:"#FF0000",outlineWeight:2,outlineOpacity:0.5,fillColor:"#FFFF00",fillOpacity:0.5}};var H={};function ArcGISSpatialReference(a){a=a||{};this.wkid=a.wkid}ArcGISSpatialReference.prototype.forward=function(a){return a};ArcGISSpatialReference.prototype.reverse=function(a){return a};ArcGISSpatialReference.prototype.getCircumference=function(){return 360};ArcGISSpatialReference.prototype.transform=function(c){if(c.spatialReference.wkid!==this.wkid){var b=H.getSpatialReference(c.spatialReference.wkid);var d=b.reverse([c.xmin,c.ymin]);var a=b.reverse([c.ymin,c.ymax]);d=this.forward(d);a=this.forward(a);return{xmin:d[0],ymin:d[1],xmax:a[0],ymax:a[1],spatialReference:{wkid:this.wkid}}}else{return c}};function ArcGISGeographic(a){a=a||{};ArcGISSpatialReference.call(this,a)}ArcGISGeographic.prototype=new ArcGISSpatialReference();function ArcGISLambertConformalConic(l){l=l||{};ArcGISSpatialReference.call(this,l);var i=l.inverse_flattening;var e=l.standard_parallel_1*B;var g=l.standard_parallel_2*B;var d=l.latitude_of_origin*B;this.a_=l.semi_major/l.unit;this.lamdaF_=l.central_meridian*B;this.FE_=l.false_easting;this.FN_=l.false_northing;var f=1.0/i;var c=2*f-f*f;this.e_=Math.sqrt(c);var a=this.calc_m_(e,c);var b=this.calc_m_(g,c);var h=this.calc_t_(d,this.e_);var j=this.calc_t_(e,this.e_);var k=this.calc_t_(g,this.e_);this.n_=Math.log(a/b)/Math.log(j/k);this.F_=a/(this.n_*Math.pow(j,this.n_));this.rF_=this.calc_r_(this.a_,this.F_,h,this.n_)}ArcGISLambertConformalConic.prototype=new ArcGISSpatialReference();ArcGISLambertConformalConic.prototype.calc_m_=function(a,b){var c=Math.sin(a);return Math.cos(a)/Math.sqrt(1-b*c*c)};ArcGISLambertConformalConic.prototype.calc_t_=function(a,e){var b=e*Math.sin(a);return Math.tan(Math.PI/4-a/2)/Math.pow((1-b)/(1+b),e/2)};ArcGISLambertConformalConic.prototype.calc_r_=function(a,F,t,n){return a*F*Math.pow(t,n)};ArcGISLambertConformalConic.prototype.calc_phi_=function(c,e,a){var b=e*Math.sin(a);return Math.PI/2-2*Math.atan(c*Math.pow((1-b)/(1+b),e/2))};ArcGISLambertConformalConic.prototype.solve_phi_=function(c,e,a){var i=0;var b=a;var d=this.calc_phi_(c,e,b);while(Math.abs(d-b)>0.000000001&&i<10){i++;b=d;d=this.calc_phi_(c,e,b)}return d};ArcGISLambertConformalConic.prototype.forward=function(d){var a=d[1]*B;var c=d[0]*B;var t=this.calc_t_(a,this.e_);var r=this.calc_r_(this.a_,this.F_,t,this.n_);var b=this.n_*(c-this.lamdaF_);var E=this.FE_+r*Math.sin(b);var N=this.FN_+this.rF_-r*Math.cos(b);return[E,N]};ArcGISLambertConformalConic.prototype.reverse=function(a){var E=a[0];var N=a[1];var d=Math.atan((E-this.FE_)/(this.rF_-(N-this.FN_)));var e=(this.n_>0?1:-1)*Math.sqrt((E-this.FE_)*(E-this.FE_)+(this.rF_-(N-this.FN_))*(this.rF_-(N-this.FN_)));var c=Math.pow((e/(this.a_*this.F_)),1/this.n_);var b=this.solve_phi_(c,this.e_,0);var f=d/this.n_+this.lamdaF_;return[f/B,b/B]};ArcGISLambertConformalConic.prototype.getCircumference=function(){return Math.PI*2*this.a_};function ArcGISTransverseMercator(a){a=a||{};ArcGISSpatialReference.call(this,a);this.a_=a.semi_major/a.unit;var b=a.inverse_flattening;this.k0_=a.scale_factor;var c=a.latitude_of_origin*B;this.lamdaF_=a.central_meridian*B;this.FE_=a.false_easting;this.FN_=a.false_northing;var f=1.0/b;this.es_=2*f-f*f;this.ep4_=this.es_*this.es_;this.ep6_=this.ep4_*this.es_;this.eas_=this.es_/(1-this.es_);this.M0_=this.calc_m_(c,this.a_,this.es_,this.ep4_,this.ep6_)}ArcGISTransverseMercator.prototype=new ArcGISSpatialReference();ArcGISTransverseMercator.prototype.calc_m_=function(e,a,b,c,d){return a*((1-b/4-3*c/64-5*d/256)*e-(3*b/8+3*c/32+45*d/1024)*Math.sin(2*e)+(15*c/256+45*d/1024)*Math.sin(4*e)-(35*d/3072)*Math.sin(6*e))};ArcGISTransverseMercator.prototype.forward=function(d){var c=d[1]*B;var a=d[0]*B;var b=this.a_/Math.sqrt(1-this.es_*Math.pow(Math.sin(c),2));var T=Math.pow(Math.tan(c),2);var C=this.eas_*Math.pow(Math.cos(c),2);var A=(a-this.lamdaF_)*Math.cos(c);var M=this.calc_m_(c,this.a_,this.es_,this.ep4_,this.ep6_);var E=this.FE_+this.k0_*b*(A+(1-T+C)*Math.pow(A,3)/6+(5-18*T+T*T+72*C-58*this.eas_)*Math.pow(A,5)/120);var N=this.FN_+this.k0_*(M-this.M0_)+b*Math.tan(c)*(A*A/2+(5-T+9*C+4*C*C)*Math.pow(A,4)/120+(61-58*T+T*T+600*C-330*this.eas_)*Math.pow(A,6)/720);return[E,N]};ArcGISTransverseMercator.prototype.reverse=function(c){var E=c[0];var N=c[1];var e=(1-Math.sqrt(1-this.es_))/(1+Math.sqrt(1-this.es_));var k=this.M0_+(N-this.FN_)/this.k0_;var b=k/(this.a_*(1-this.es_/4-3*this.ep4_/64-5*this.ep6_/256));var d=b+(3*e/2-27*Math.pow(e,3)/32)*Math.sin(2*b)+(21*e*e/16-55*Math.pow(e,4)/32)*Math.sin(4*b)+(151*Math.pow(e,3)/6)*Math.sin(6*b)+(1097*Math.pow(e,4)/512)*Math.sin(8*b);var i=this.eas_*Math.pow(Math.cos(d),2);var g=Math.pow(Math.tan(d),2);var f=this.a_/Math.sqrt(1-this.es_*Math.pow(Math.sin(d),2));var j=this.a_*(1-this.es_)/Math.pow((1-this.es_*Math.pow(Math.sin(d),2)),3/2);var D=(E-this.FE_)/(f*this.k0_);var h=d-(f*Math.tan(d)/j)*(D*D/2-(5+3*g+10*i-4*i*i-9*this.eas_)*Math.pow(D,4)/24+(61+90*g+28*i+45*g*g-252*this.eas_-3*i*i)*Math.pow(D,6)/720);var a=this.lamdaF_+(D-(1+2*g+i)*Math.pow(D,3)/6+(5-2*i+28*g-3*i*i+8*this.eas_+24*g*g)*Math.pow(D,5)/120)/Math.cos(d);return[a/B,h/B]};ArcGISTransverseMercator.prototype.getCircumference=function(){return Math.PI*2*this.a_};function ArcGISSphereMercator(a){a=a||{};ArcGISSpatialReference.call(this,a);this.a_=(a.semi_major||6378137.0)/(a.unit||1);this.lamdaF_=(a.central_meridian||0.0)*B}ArcGISSphereMercator.prototype=new ArcGISSpatialReference();ArcGISSphereMercator.prototype.forward=function(c){var a=c[1]*B;var b=c[0]*B;var E=this.a_*(b-this.lamdaF_);var N=(this.a_/2)*Math.log((1+Math.sin(a))/(1-Math.sin(a)));return[E,N]};ArcGISSphereMercator.prototype.reverse=function(a){var E=a[0];var N=a[1];var b=Math.PI/2-2*Math.atan(Math.exp(-N/this.a_));var c=E/this.a_+this.lamdaF_;return[c/B,b/B]};ArcGISSphereMercator.prototype.getCircumference=function(){return Math.PI*2*this.a_};function ArcGISFlatSpatialReference(a){a=a||{};ArcGISSpatialReference.call(this,a);this.lng_=a.latlng.xmin;this.lat_=a.latlng.ymin;this.x_=a.coords.xmin;this.y_=a.coords.ymin;this.xscale_=(a.coords.xmax-a.coords.xmin)/(a.latlng.xmax-a.latlng.xmin);this.yscale_=(a.coords.ymax-a.coords.ymin)/(a.latlng.ymax-a.latlng.ymin)}ArcGISFlatSpatialReference.prototype=new ArcGISSpatialReference();ArcGISFlatSpatialReference.prototype.forward=function(a){var E=this.x_+(a[0]-this.lng_)*this.xscale_;var N=this.y_+(a[1]-this.lat_)*this.yscale_;return[E,N]};ArcGISFlatSpatialReference.prototype.reverse=function(c){var a=this.lng_+(c[0]-this.x_)/this.xscale_;var b=this.lat_+(c[1]-this.y_)/this.yscale_;return[a,b]};ArcGISFlatSpatialReference.prototype.getCircumference=function(){return this.xscale_*360};var J=new ArcGISGeographic({wkid:4326});var Z=new ArcGISGeographic({wkid:4269});var X=new ArcGISSphereMercator({wkid:102113,semi_major:6378137.0,central_meridian:0,unit:1});H={'4326':J,'4269':Z,'102113':X};H.addSpatialReference=function(c,a){var e=this[''+c];if(e){return e}if(a instanceof ArcGISSpatialReference){this[''+c]=a;return a}var d=a;var b={wkid:c};var f=K(d,"PROJECTION[\"","\"]");var g=K(d,"SPHEROID[","]").split(",");if(f!==""){b.unit=parseFloat(K(K(d,"PROJECTION",""),"UNIT[","]").split(",")[1]);b.semi_major=parseFloat(g[1]);b.inverse_flattening=parseFloat(g[2]);b.latitude_of_origin=parseFloat(K(d,"\"Latitude_Of_Origin\",","]"));b.central_meridian=parseFloat(K(d,"\"Central_Meridian\",","]"));b.false_easting=parseFloat(K(d,"\"False_Easting\",","]"));b.false_northing=parseFloat(K(d,"\"False_Northing\",","]"))}switch(f){case"":e=new ArcGISSpatialReference(b);break;case"Lambert_Conformal_Conic":b.standard_parallel_1=parseFloat(K(d,"\"Standard_Parallel_1\",","]"));b.standard_parallel_2=parseFloat(K(d,"\"Standard_Parallel_2\",","]"));e=new ArcGISLambertConformalConic(b);break;case"Transverse_Mercator":b.scale_factor=parseFloat(K(d,"\"Scale_Factor\",","]"));e=new ArcGISTransverseMercator(b);break;default:}if(e){this[''+c]=e}return e};H.getSpatialReference=function(a){return this[''+a]};function ArcGISLayer(a){this.url=a;this.loaded_=false;this.correct_=false;this.definition=null}ArcGISLayer.prototype.loadInfo=function(c){var b=this;if(this.loaded_&&this.correct_){return}w.getJSON(this.url,{f:'json'},'callback',function(a){if(a.error){b.correct_=false}else{b.correct_=true;R(a,b)}b.loaded_=true;L(b,"load");if(c){c()}})};ArcGISLayer.prototype.hasLoaded=function(){return this.loaded_};ArcGISLayer.prototype.getFieldNames=function(){var a=[];if(this.hasLoaded()){for(var i=0;i<this.fields.length;i++){a.push(this.fields[i].name)}}return a};ArcGISLayer.prototype.isInScale=function(a){if(this.maxScale&&this.maxScale>a){return false}if(this.minScale&&this.minScale<a){return false}return true};ArcGISLayer.prototype.query=function(c,a){if(!c){return}var b=R(c,{});b.f=b.f||'json';if(b.geometry&&!bk(b.geometry)){b.geometry=w.fromGeometryToJSON(b.geometry)}if(b.geometry){b.spatialRel=b.spatialRel||bc}if(b.outFields&&!bk(b.outFields)){b.outFields=b.outFields.join(',')}b.returnGeometry=b.returnGeometry===false?false:true;w.getJSON(this.url+'/query',b,'callback',a)};function ArcGISMapService(d,e){this.url=d;var b=d.split("/");this.name=b[b.length-2].replace(/_/g,' ');var c=this;this.loaded_=false;this.correct_=false;w.getJSON(d,{f:'json'},'callback',function(a){c.init_(a,e)})}ArcGISMapService.prototype.init_=function(e,f){var g=this;function doneLoad(a){g.loaded_=true;for(var i=0,c=g.layers_.length;i<c;i++){var b=g.layers_[i];if(b.subLayerIds){b.subLayers=[];for(var j=0,jc=b.subLayerIds.length;j<jc;j++){var d=g.getLayer(b.subLayerIds[j]);b.subLayers.push(d);d.parentLayer=b}}}g.initialExtent.xmin=Math.max(g.initialExtent.xmin,g.fullExtent.xmin);g.initialExtent.ymin=Math.max(g.initialExtent.ymin,g.fullExtent.ymin);g.initialExtent.xmax=Math.min(g.initialExtent.xmax,g.fullExtent.xmax);g.initialExtent.ymax=Math.min(g.initialExtent.ymax,g.fullExtent.ymax);L(g,"load");if(f){f()}}if(e.error){this.correct_=false}else{this.correct_=true;R(e,this);var k=[];var m=[];for(var i=0,c=e.layers.length;i<c;i++){var l=e.layers[i];var h=new ArcGISLayer(this.url+'/'+l.id);R(l,h);h.visible=l.defaultVisibility;k.push(h);m.push(l.id)}this.layers_=k;delete this.layers;this.spatialReference_=H.getSpatialReference(''+e.spatialReference.wkid);if(!this.spatialReference_){this.exportMap({bbox:e.fullExtent,bboxSR:e.spatialReference.wkid,size:'1,1',imageSR:4326,layers:'hide:'+m.join(',')},function(a){var b=new ArcGISFlatSpatialReference({wkid:e.spatialReference.wkid,latlng:a.extent,coords:e.fullExtent});H.addSpatialReference(e.spatialReference.wkid,b);g.spatialReference_=b;doneLoad(e)})}else{doneLoad(e)}}};ArcGISMapService.prototype.hasLoaded=function(){return this.loaded_};ArcGISMapService.prototype.loadedCorrectly=function(){return this.loaded_&&this.correct_};ArcGISMapService.prototype.getSpatialReference=function(){return this.spatialReference_};ArcGISMapService.prototype.getLayers=function(){return this.layers_};ArcGISMapService.prototype.getLayer=function(a){var b=this.layers_;if(b){for(var i=0,c=b.length;i<c;i++){if(a===b[i].id){return b[i]}if(bk(a)&&b[i].name.toLowerCase()===a.toLowerCase()){return b[i]}}}return null};ArcGISMapService.prototype.getLayerIds=function(d){var b;if(bk(d)){b=this.getLayer(d);if(b){return b.id}}else if(be(d)){var a=[];for(var i=0,c=d.length;i<c;i++){b=this.getLayer(d[i]);a.push(b?b.id:-1)}return a}return-1};ArcGISMapService.prototype.exportMap=function(k,b){if(!k){return}var h=R(k,{});h.f=h.f||'json';var a=h.bbox;if(a.xmin){h.bbox=''+a.xmin+','+a.ymin+','+a.xmax+','+a.ymax}h.size=h.size||''+h.width+','+h.height;h.transparent=(h.transparent===false?false:true);var e=[];var d=[];var g=false;var f;var i,c;for(i=0,c=this.layers_.length;i<c;i++){f=this.layers_[i];if(f.subLayers){for(var j=0,jc=f.subLayers.length;j<jc;j++){if(f.subLayers[j].visible===false){f.visible=false;break}}}}for(i=0,c=this.layers_.length;i<c;i++){f=this.layers_[i];if(f.visible!==f.defaultVisibility){g=true}if(f.visible===true){e.push(f.id)}if(f.definition){d.push(f.id+':'+f.definition)}}if(g===true){if(!h.layers||!bk(h.layers)){h.layers='show:'+e.join(',')}}if(d.length>0){if(!h.layerDefs||!bk(h.layerDefs)){h.layerDefs=d.join(';')}}if(e.length===0){b({})}else{w.getJSON(this.url+'/export',h,'callback',b)}};ArcGISMapService.prototype.identify=function(c,a){if(!c){return}var b=R(c,{});b.f=b.f||'json';if(!bk(b.geometry)){b.geometry=w.fromGeometryToJSON(b.geometry)}var d=b.mapExtent;if(d.xmin){b.mapExtent=''+d.xmin+','+d.ymin+','+d.xmax+','+d.ymax}if(!b.imageDisplay){b.imageDisplay=''+b.width+','+b.height+','+b.dpi}if(b.layers&&!bk(b.layers)){b.layers='all:'+this.getLayerIds(b.layers).join(',')}b.returnGeometry=(b.returnGeometry===false?false:true);w.getJSON(this.url+'/identify',b,'callback',a)};ArcGISMapService.prototype.find=function(c,a){if(!c){return}var b=R(c,{});b.f=b.f||'json';if(b.layers&&!bk(b.layers)){b.layers=this.getLayerIds(b.layers).join(',')}if(b.searchFields&&!bk(b.searchFields)){b.searchFields=b.searchFields.join(',')}b.contains=(b.contains===false?false:true);b.returnGeometry=(b.returnGeometry===false?false:true);w.getJSON(this.url+'/find',b,'callback',a)};ArcGISMapService.prototype.generateKML=function(a){};ArcGISMapService.prototype.queryLayer=function(d,b,a){var c=this.getLayer(d);if(c){c.query(b,a)}};function ArcGISGeometryService(a){this.url=a}ArcGISGeometryService.prototype.project=function(b,a){if(!b){return}b.f=b.f||'json';if(!bk(b.geometries)){var e=I;var d=[];for(var i=0,c=b.geometries.length;i<c;i++){var g=b.geometries[i];if(i===0){if(g.points){e=P}else if(g.paths){e=Q}else if(g.rings){e=bq}}d.push(w.fromGeometryToJSON(g,false))}b.geometries='{ geometryType:'+e+', geometries:['+d.join(',')+']}'}w.getJSON(this.url+'/project',b,"callback",a)};function ArcGISGeocodeService(c){this.url=c;var b=this;w.getJSON(c,{f:'json'},'callback',function(a){b.init_(a)})}ArcGISGeocodeService.prototype.init_=function(a){R(a,this);L(this,'load')};ArcGISGeocodeService.prototype.hasLoaded=function(){return this.addressFields!==null};ArcGISGeocodeService.prototype.findAddressCandidates=function(a,b){var c=R(a,{});c.f=c.f||'json';if(c.inputs){R(c.inputs,c);delete c.inputs}if(be(c.outFields)){c.outFields=c.outFields.join(',')}w.getJSON(this.url+'/findAddressCandidates',c,'callback',b)};ArcGISGeocodeService.prototype.geocode=function(a,b){this.findAddressCandidates(a,b)};ArcGISGeocodeService.prototype.reverseGeocode=function(a,b){a.f=a.f||'json';if(!bk(a.location)){a.location=w.fromGeometryToJSON(a.location)}w.getJSON(this.url+'/reverseGeocode',a,'callback',b)};function ArcGISProjection(b,a){if(!b){throw new Error('map service is not tiled');}this.tileInfo_=b;this.spatialReference_=H.getSpatialReference(b.spatialReference.wkid);if(!this.spatialReference_){throw new Error('unsupported Spatial Reference');}this.zoomOffset_=Math.floor(Math.log(this.spatialReference_.getCircumference()/this.tileInfo_.lods[0].resolution/256)/Math.LN2+0.5);this.fullExtent_=a}ArcGISProjection.prototype=new GProjection();ArcGISProjection.prototype.fromLatLngToPixel=function(a,d){if(a===null||isNaN(a.lat())||isNaN(a.lng())){return null}var c=this.spatialReference_.forward([a.lng(),a.lat()]);var b=d-this.zoomOffset_;var e=this.getUnitsPerPixel(d);var f=Math.round((c[0]-this.tileInfo_.origin.x)/e);var g=Math.round((this.tileInfo_.origin.y-c[1])/e);return new GPoint(f,g)};ArcGISProjection.prototype.getUnitsPerPixel=function(b){var a=b-this.zoomOffset_;var c=Number.MAX_VALUE;if(this.tileInfo_.lods[a]){c=this.tileInfo_.lods[a].resolution}else{var d=Math.pow(2,b-this.maxResolution());c=this.tileInfo_.lods[this.tileInfo_.lods.length-1].resolution/d}return c};ArcGISProjection.prototype.getScale=function(b){var a=b-this.zoomOffset_;var c=0;if(this.tileInfo_.lods[a]){c=this.tileInfo_.lods[a].scale}else{var d=Math.pow(2,b-this.maxResolution());c=this.tileInfo_.lods[this.tileInfo_.lods.length-1].scale/d}return c};ArcGISProjection.prototype.fromPixelToLatLng=function(f,d,c){if(f===null){return null}var a=d-this.zoomOffset_;var e=this.getUnitsPerPixel(d);var x=f.x*e+this.tileInfo_.origin.x;var y=this.tileInfo_.origin.y-f.y*e;var b=this.spatialReference_.reverse([x,y]);return new GLatLng(b[1],b[0])};ArcGISProjection.prototype.tileCheckRange=function(d,a,e){var c=a-this.zoomOffset_;if(this.tileInfo_.lods[c]){var b=this.fullExtent_;if(!b){return true}var g=d.x*e*this.tileInfo_.lods[c].resolution+this.tileInfo_.origin.x;var h=this.tileInfo_.origin.y-(d.y+1)*e*this.tileInfo_.lods[c].resolution;var i=(d.x+1)*e*this.tileInfo_.lods[c].resolution+this.tileInfo_.origin.x;var j=this.tileInfo_.origin.y-d.y*e*this.tileInfo_.lods[c].resolution;var f=!(b.xmin>i||b.xmax<g||b.ymax<h||b.ymin>j);return f}else{return false}};ArcGISProjection.prototype.getWrapWidth=function(a){var b=a-this.zoomOffset_;if(this.tileInfo_.lods[b]){return this.spatialReference_.getCircumference()/this.tileInfo_.lods[b].resolution}else{return Number.MAX_VALUE}};ArcGISProjection.prototype.getTileSize=function(){return this.tileInfo_.rows};ArcGISProjection.prototype.minResolution=function(){return this.zoomOffset_};ArcGISProjection.prototype.maxResolution=function(){return this.zoomOffset_+this.tileInfo_.lods.length-1};ArcGISProjection.prototype.getSpatialReference=function(){return this.spatialReference_};function ArcGISTileLayer(f,g){g=g||{};this.mapService_=(f instanceof ArcGISMapService)?f:new ArcGISMapService(f);if(g.name){this.mapService_.name=g.name}if(g.hosts){var c=K(this.mapService_.url,'','://');var b=K(this.mapService_.url,'://','/');var a=K(this.mapService_.url,c+'://'+b,'');this.urlTemplate_=c+'://'+g.hosts+a;this.numOfHosts_=parseInt(K(g.hosts,'[',']'),10)}if(this.mapService_.hasLoaded()){this.init_(g)}else{var e=this;bh.addListener(this.mapService_,'load',function(){e.init_(g)});var h=g.copyrights;this.projection_=g.projection;var i=g.minResolution||(this.projection_?this.projection_.minResolution():0);var d=g.maxResolution||(this.projection_?this.projection_.maxResolution():19);GTileLayer.call(this,h,i,d,g)}}ArcGISTileLayer.prototype=new GTileLayer();ArcGISTileLayer.prototype.init_=function(c){this.projection_=new ArcGISProjection(this.mapService_.tileInfo,this.mapService_.fullExtent);var a=c.copyrights;if(!a){a=new GCopyrightCollection('');a.addCopyright(new GCopyright(1,w.fromEnvelopeToLatLngBounds(this.mapService_.fullExtent),this.projection_.zoomOffset_,this.mapService_.copyrightText))}var b=c.minResolution||this.projection_.minResolution();var d=c.maxResolution||this.projection_.maxResolution();if(c.tileUrlTemplate){delete c.tileUrlTemplate}GTileLayer.call(this,a,b,d,c);bh.trigger(this,"load")};ArcGISTileLayer.prototype.getMapService=function(){return this.mapService_};ArcGISTileLayer.prototype.getFullBounds=function(){this.fullBounds_=this.fullBounds_||w.fromEnvelopeToLatLngBounds(this.mapService_.fullExtent);return this.fullBounds_};ArcGISTileLayer.prototype.getInitialBounds=function(){this.initialBounds_=this.initialBounds_||w.fromEnvelopeToLatLngBounds(this.mapService_.initialExtent);return this.initialBounds_};ArcGISTileLayer.prototype.getName=function(){return this.mapService_.name};ArcGISTileLayer.prototype.getProjection=function(){return this.projection_};ArcGISTileLayer.prototype.getTileUrl=function(b,a){var z=a-(this.projection_?this.projection_.minResolution():this.minResolution());if(!isNaN(b.x)&&!isNaN(b.y)&&z>=0){var u=this.mapService_.url;if(this.urlTemplate_){u=this.urlTemplate_.replace('['+this.numOfHosts_+']',''+((b.y+b.x)%this.numOfHosts_))}return u+'/tile/'+z+'/'+b.y+'/'+b.x}return''};ArcGISTileLayer.prototype.hasLoaded=function(){return this.mapService_.hasLoaded()};function ArcGISMapType(a,b){var d=this;b=b||{};var c=a;if(bk(a)){c=[new ArcGISTileLayer(a)]}else if(a instanceof ArcGISTileLayer){c=[a]}var e=0,i;function handleLayerLoad(){e++;if(e===c.length){d.init_(c,b)}}for(i=0;i<c.length;i++){var g=c[i].getMapService();if(g.hasLoaded()===false){bh.addListener(g,'load',handleLayerLoad)}else{e++}}if(e===c.length){this.init_(c,b)}else{var f=null;if(b.projection){f=b.projection;for(i=0;i<c.length;i++){if(!c[i].projection_){c[i].projection_=f}}}else{f=c[0].projection_}if(f){b.tileSize=f.getTileSize()}GMapType.call(this,c,f||new GMercatorProjection(20),b.name||c[0].getMapService().name,b)}}ArcGISMapType.prototype=new GMapType();ArcGISMapType.prototype.init_=function(a,c){c.tileSize=a[0].getProjection().getTileSize();var b=c.name||a[0].getMapService().name;GMapType.call(this,a,a[0].getProjection(),b,c);bh.trigger(this,"load")};function ArcGISMapOverlay(c,a){a=a||{};this.mapService_=(c instanceof ArcGISMapService)?c:new ArcGISMapService(c);if(a.name){this.mapService_.name=a.name}this.minZoom_=a.minResolution;this.maxZoom_=a.maxResolution;if(this.mapService_.hasLoaded()){this.init_(a)}else{var b=this;bh.addListener(this.mapService_,'load',function(){b.init_(a)})}}ArcGISMapOverlay.prototype=new GOverlay();ArcGISMapOverlay.prototype.init_=function(a){this.opacity_=a.opacity||1;this.exportParams_=a.exportParams||{};this.drawing_=false;this.redraw_=false;if(this.img_===null){this.refresh()}if(this.map_){this.setupMapType_()}bh.trigger(this,"load")};ArcGISMapOverlay.prototype.setupMapType_=function(a){if(a){a.agsOvs_=a.agsOvs_||[];if(bi(a.agsOvs_,this)===-1){a.agsOvs_.push(this)}}else if(this.map_){var b=this.map_.getMapTypes();for(var i=0;i<b.length;i++){a=b[i];a.agsOvs_=a.agsOvs_||[];if(bi(a.agsOvs_,this)===-1){a.agsOvs_.push(this)}}}};ArcGISMapOverlay.prototype.getMapService=function(){return this.mapService_};ArcGISMapOverlay.prototype.getFullBounds=function(){this.fullBounds_=this.fullBounds_||w.fromEnvelopeToLatLngBounds(this.mapService_.fullExtent);return this.fullBounds_};ArcGISMapOverlay.prototype.getInitialBounds=function(){this.initialBounds_=this.initialBounds_||w.fromEnvelopeToLatLngBounds(this.mapService_.initialExtent);return this.initialBounds_};ArcGISMapOverlay.prototype.getName=function(){return this.mapService_.name};ArcGISMapOverlay.prototype.setOpacity=function(b){var a=Math.min(Math.max(b,0),1);this.opacity_=a;var d=this.img_;if(d){var c=d.style;if(typeof c.opacity!=='undefined'){c.opacity=a}if(typeof c.filters!=='undefined'){c.filters.alpha.opacity=Math.floor(100*a)}if(typeof c.filter!=='undefined'){c.filter="alpha(opacity:"+Math.floor(a*100)+")"}}};ArcGISMapOverlay.prototype.getOpacity=function(){return this.opacity_};ArcGISMapOverlay.prototype.hasLoaded=function(){return this.mapService_.hasLoaded()};ArcGISMapOverlay.prototype.refresh=function(){if(!this.mapService_.hasLoaded()||this.map_===null){return}if(this.drawing_===true){this.redraw_=true;return}if(this.img_!==null&&this.moveend_){this.div_.removeChild(this.img_);this.img_=null}if(this.isHidden()){return}var i=this.map_.getBounds();var k=this.map_.getCurrentMapType().getProjection().getSpatialReference();var h=this;var j=this.exportParams_;j.size=''+this.map_.getSize().width+','+this.map_.getSize().height;j.bbox=w.fromLatLngBoundsToEnvelope(i,k);j.bboxSR=k.wkid;j.imageSR=k.wkid;this.drawing_=true;bh.trigger(this,'drawstart');this.mapService_.exportMap(j,function(f){h.drawing_=false;if(h.redraw_===true){h.redraw_=false;h.refresh();return}var a=h.div_;if(f.href){var b=w.fromEnvelopeToLatLngBounds(f.extent);var e=h.map_.getCurrentMapType().getProjection().getWrapWidth(h.map_.getZoom());var c=h.map_.fromLatLngToDivPixel(b.getSouthWest());var d=h.map_.fromLatLngToDivPixel(b.getNorthEast());a.style.width=f.width+"px";a.style.height=f.height+"px";a.style.left=c.x%e+"px";a.style.top=d.y+"px";if(h.img_!==null){h.img_.src=f.href}else{var g=document.createElement('img');g.src=f.href;a.appendChild(g);h.img_=g}h.moveend_=false;h.setOpacity(h.opacity_)}else{if(h.img_!==null){a.removeChild(h.img_);h.img_=null}}bh.trigger(h,'drawend',f)})};ArcGISMapOverlay.prototype.initialize=function(a){var b=document.createElement("div");b.style.position="absolute";a.getPane(G_MAP_OVERLAY_LAYER_PANE).appendChild(b);this.map_=a;this.zoomLevel_=a.getZoom();this.div_=b;this.img_=null;this.moveEndListener_=bh.bind(this.map_,"moveend",this,function(){this.moveend_=true;this.refresh()});this.mapTypeChangeListener_=bh.bind(this.map_,"maptypechanged",this,this.refresh);this.mapTypeAddListener_=bh.bind(this.map_,"addmaptype",this,this.setupMapType_);this.map_.getArcGISOverlays().push(this);if(this.hasLoaded()){this.setupMapType_()}this.show()};ArcGISMapOverlay.prototype.remove=function(){bh.removeListener(this.moveEndListener_);bh.removeListener(this.mapTypeChangeListener_);this.div_.parentNode.removeChild(this.div_);bj(this.map_.getArcGISOverlays(),this);var b=this.map_.getMapTypes();for(var i=0;i<b.length;i++){var a=b[i];if(a.agsOvs_){bj(a.agsOvs_,this)}}};ArcGISMapOverlay.prototype.getCopyright=function(a,b){if(!this.isHidden()&&this.getFullBounds().intersects(a)&&this.isInZoomRange_()){return this.mapService_.copyrightText}};ArcGISMapOverlay.prototype.copy=function(){return new ArcGISMapOverlay(this.url)};ArcGISMapOverlay.prototype.isHidden=function(){return!(this.visible_&&this.isInZoomRange_()&&this.getFullBounds().intersects(this.map_.getBounds()))};ArcGISMapOverlay.prototype.isInZoomRange_=function(){var z=this.map_.getZoom();if((this.minZoom_!==undefined&&z<this.minZoom_)||(this.maxZoom_!==undefined&&z>this.maxZoom_)){return false}return true};ArcGISMapOverlay.prototype.show=function(){this.visible_=true;this.div_.style.visibility='visible';this.refresh()};ArcGISMapOverlay.prototype.hide=function(){this.visible_=false;this.div_.style.visibility='hidden'};ArcGISMapOverlay.prototype.redraw=function(a){};function ArcGISTileLayerOverlay(a,d){var b=this;d=d||{};var c=a;if(bk(a)){c=new ArcGISTileLayer(a)}var e=c.getMapService();if(e.hasLoaded()===false){bh.addListener(e,'load',function(){b.init_(c,d)})}else{this.init_(c,d)}GTileLayerOverlay.call(this,c,d)}ArcGISTileLayerOverlay.prototype=new GTileLayerOverlay();ArcGISTileLayerOverlay.prototype.init_=function(a,b){GTileLayerOverlay.call(this,a,b);bh.trigger(this,"load");if(this.map_){this.refresh()}};ArcGISTileLayerOverlay.prototype.initialize=function(a){this.map_=a;a.getArcGISOverlays().push(this);GTileLayerOverlay.prototype.initialize.call(this,a);this.mapTypeChangeHide_=false;this.mapTypeChangeListener_=bh.bind(this.map_,"maptypechanged",this,this.onMapTypeChanged_)};ArcGISTileLayerOverlay.prototype.onMapTypeChanged_=function(){var b=this.getTileLayer().getProjection().getSpatialReference().wkid;var a=this.map_.getCurrentMapType().getProjection().getSpatialReference().wkid;if(b!==a){this.mapTypeChangeHide_=true;this.hide()}else{if(this.mapTypeChangeHide_===true){this.show();this.mapTypeChangeHide_=false}}};ArcGISTileLayerOverlay.prototype.remove=function(){bj(this.map_.getArcGISOverlays(),this);bh.removeListener(this.mapTypeChangeListener_);GTileLayerOverlay.prototype.remove.call(this)};ArcGISTileLayerOverlay.prototype.getName=function(){return this.getTileLayer().getName()};GMercatorProjection.prototype.getSpatialReference=function(){return H.getSpatialReference('102113')};GMapType.prototype.getCopyrights=function(b,c){var a=[],i,cp;var d=this.getTileLayers();for(i=0;i<d.length;i++){cp=d[i].getCopyright(b,c);if(cp){a.push(cp)}}if(this.agsOvs_){for(i=0;i<this.agsOvs_.length;i++){cp=this.agsOvs_[i].getCopyright(b,c);if(cp&&bi(a,cp,true)===-1){a.push(cp)}}}return a};GMap2.prototype.setBounds=function(a){var b=a.getCenter();var z=this.getBoundsZoomLevel(a)+1;this.setCenter(b,z)};GMap2.prototype.getSpatialReference=function(){return this.getCurrentMapType().getProjection().getSpatialReference()};GMap2.prototype.getArcGISOverlays=function(){this.agsOvs_=this.agsOvs_||[];return this.agsOvs_};GMap2.prototype.getArcGISResults=function(){this.agsResults_=this.agsResults_||[];return this.agsResults_};GMap2.prototype.clearArcGISResults=function(){if(this.agsResults_){for(var i=0,c=this.agsResults_.length;i<c;i++){bh.clearInstanceListeners(this.agsResults_[i]);this.removeOverlay(this.agsResults_[i]);delete this.agsResults_[i]}}this.agsResults_=[]};GMap2.prototype.removeOverlays=function(a){if(be(a)){for(var i=0,c=a.length;i<c;i++){this.removeOverlays(a[i])}}else if(a){this.removeOverlay(a)}};GMap2.prototype.addOverlays=function(a){if(be(a)){for(var i=0,c=a.length;i<c;i++){this.addOverlays(a[i])}}else if(a){this.addOverlay(a)}};GMap2.prototype.addArcGISMap=function(e,f){var d=this;var g=new ArcGISMapService(e,function(){if(g.singleFusedMapCache){var a=new ArcGISTileLayer(g);var b=new ArcGISMapType([a]);d.addMapType(b);if(f){f(b)}}else{var c=new ArcGISMapOverlay(g);d.addOverlay(c);if(f){f(c)}}})};GMap2.prototype.enableArcGISClick=function(){this.agsClickListener_=this.agsClickListener_||bh.addListener(this,'click',this.doArcGISIdentify_)};GMap2.prototype.arcgisClickEnabled=function(){return this.agsClickListener_!==null};GMap2.prototype.disableArcGISClick=function(){if(this.agsClickListener_){bh.removeListener(this.agsClickListener_);this.agsClickListener_=null}};GMap2.prototype.setArcGISClickOptions=function(a){this.agsClickOpts_=a||{}};GMap2.prototype.doArcGISIdentify_=function(p,s,o){var n=this;var q=this.agsClickOpts_||{};var v;var t;var u=96;function processIdentifyResults(f,d){var g='';if(d.results){for(var i=0,c=d.results.length;i<c;i++){var r=d.results[i];if(i>0){g+='<hr/>'}g+='<div><table>';g+='<tr><td class="ags-layername">'+r.layerName+'</td></tr>';g+='<tr><td><table>';var a=r.attributes;var b=true;for(var x in a){if(a.hasOwnProperty(x)){b=!b;g+='<tr class="ags-row-'+(b?'odd':'even')+'">';g+='<td class="ags-fieldname">'+x+'</td>';var h=a[x];h=(h===null||typeof h==='undefined')?'':''+h;g+='<td class="ags-fieldvalue">'+h+'</td></tr>'}}g+='</table></td></tr></table></div>';if(r.geometry){var l=w.getOptionValue(U.defaultStyle,q,'style',f.name,r.layerName);var m=w.fromFeatureToOverlays(r,null,l);for(var j=0;j<m.length;j++){m[j].html=g;n.agsResults_.push(m[j]);n.addOverlay(m[j])}}}}else if(d.error){g='<div class  =  "ags-error">'+'error code: '+d.error.code+' <br/>message:'+d.error.message+'<br/>details:'+d.error.details.join(';')+'</div>'}if(g.length>0){var e=n.getInfoWindow().getTabs();var k=new GInfoWindowTab(f.name,'<div class  =  "ags-infowindow">'+g+'</div>');e.push(k);n.openInfoWindowTabsHtml(s,e)}}function identifyService(e){var i=n.agsSessionID_;var j=e.getSpatialReference();var f=n.getBounds();var h=w.fromLatLngBoundsToEnvelope(f,j);var b=n.getSize();var c=w.fromLatLngToPoint(s,j);var d={geometry:''+c.x+','+c.y,geometryType:I,sr:j.wkid,layers:q.layers||'top',tolerance:q.tolerance||5,mapExtent:h,imageDisplay:''+b.width+','+b.height+','+u,returnGeometry:q.returnGeometry===true};var g=d;if(q.serviceOptions&&q.serviceOptions[e.name]){g=R(q.serviceOptions[e.name],d,true)}e.identify(g,function(a){if(i===n.agsSessionID_){processIdentifyResults(e,a)}else{}})}function getIdentifyServices(){var c=null,i,tile;var e=[];var d=n.getArcGISOverlays();for(i=0;i<d.length;i++){if(!d[i].isHidden()){if(d[i]instanceof ArcGISMapOverlay){if(d[i].getFullBounds().containsLatLng(s)){e.push(d[i].getMapService())}}else if(d[i]instanceof ArcGISTileLayerOverlay){tile=d[i].getTileLayer();if(tile.getFullBounds().containsLatLng(s)){e.push(tile.getMapService())}}}}var a=n.getCurrentMapType();if(a instanceof ArcGISMapType){var b=a.getTileLayers();for(i=0;i<b.length;i++){tile=b[i];if(i===0){u=tile.getMapService().tileInfo.dpi}if(tile.getFullBounds().containsLatLng(s)){e.push(tile.getMapService())}}}return e}if(p===null&&s){this.getInfoWindow().getTabs().length=0;this.clearArcGISResults();this.agsSessionID_=Math.floor(Math.random()*100000);v=getIdentifyServices();for(var i=0;i<v.length;i++){identifyService(v[i])}}else if(o&&p.html){this.openInfoWindowHtml(o,'<div class  = "ags-infowindow">'+p.html+'</div>')}};w.fromEnvelopeToLatLngBounds=function(c){var b=H.getSpatialReference(c.spatialReference.wkid);b=b||J;var d=b.reverse([c.xmin,c.ymin]);var a=b.reverse([c.xmax,c.ymax]);return new GLatLngBounds(new GLatLng(d[1],d[0]),new GLatLng(a[1],a[0]))};w.fromLatLngBoundsToEnvelope=function(a,c){var d=c.forward([a.getSouthWest().lng(),a.getSouthWest().lat()]);var b=c.forward([a.getNorthEast().lng(),a.getNorthEast().lat()]);return{xmin:d[0],ymin:d[1],xmax:b[0],ymax:b[1],spatialReference:{wkid:c.wkid}}};w.fromPointToLatLng=function(d,a){var c=d.spatialReference||a;var b=c?H.getSpatialReference(c.wkid):J;b=b||J;if(isNaN(d.x)||isNaN(d.y)){return null}var p=b.reverse([d.x,d.y]);return new GLatLng(p[1],p[0])};w.fromLatLngToPoint=function(a,c){var b=null;if(c){b=(c instanceof ArcGISSpatialReference)?c:H.getSpatialReference(c.wkid)}b=b||J;var p=b.forward([a.lng(),a.lat()]);return{x:p[0],y:p[1],spatialReference:{wkid:b.wkid}}};w.createCircle=function(c,d,b){b=b||72;var a=[],t,x,y;for(var i=0;i<b;i++){t=i*B*360/b;x=c.x+d*Math.cos(t);y=c.y+d*Math.sin(t);a.push([x,y])}a.push(a[0]);return{rings:[a],spatialReference:c.spatialReference}};w.fromFeatureToOverlays=function(a,e,g,b){var k=[];var m=null;var h;var d=a.geometry;if(e){if(e instanceof ArcGISSpatialReference){m=e}else{m=H.getSpatialReference(e.wkid)}}else{m=H.getSpatialReference(d.spatialReference.wkid)}if(m===null){return k}var l=g||U.style;var x,i,ic,j,jc,parts,part,lnglat,glatlngs;var c='';if(b){c=a.attributes[b]}var f='<table>';for(x in a.attributes){if(a.attributes.hasOwnProperty(x)){f+='<tr><td class="ags-fieldname">'+x+'</td><td class="ags-fieldvalue">'+a.attributes[x]+'</td></tr>'}}f+='</table>';if(d.x){lnglat=m.reverse([d.x,d.y]);h=new GMarker(new GLatLng(lnglat[1],lnglat[0]),{icon:l.icon,title:c});h.attributes=a.attributes;h.html=f;k.push(h)}else{parts=d.points||d.paths||d.rings;if(!parts){return k}for(i=0,ic=parts.length;i<ic;i++){part=parts[i];if(d.points){lnglat=m.reverse(part);h=new GMarker(new GLatLng(lnglat[1],lnglat[0]),{icon:l.icon})}else{if(part.length>U.maxPolyPoints){continue}glatlngs=[];for(j=0,jc=part.length;j<jc;j++){lnglat=m.reverse(part[j]);glatlngs.push(new GLatLng(lnglat[1],lnglat[0]))}if(d.paths){h=new GPolyline(glatlngs,l.strokeColor,l.strokeWeight,l.strokeOpacity)}else if(d.rings){h=new GPolygon(glatlngs,l.outlineColor,l.outlineWeight,l.outlineOpacity,l.fillColor,l.fillOpacity)}}h.attributes=a.attributes;h.html=f;k.push(h)}}return k};var bp={'SpatialReference':ArcGISSpatialReference,'Geographic':ArcGISGeographic,'LambertConformalConic':ArcGISLambertConformalConic,'SphereMercator':ArcGISSphereMercator,'TransverseMercator':ArcGISTransverseMercator,'FlatSpatialReference':ArcGISFlatSpatialReference,'SpatialReferences':H,'MapService':ArcGISMapService,'Layer':ArcGISLayer,'GeocodeService':ArcGISGeocodeService,'GeometryService':ArcGISGeometryService,'Util':w,'Config':U,'Projection':ArcGISProjection,'TileLayer':ArcGISTileLayer,'TileLayerOverlay':ArcGISTileLayerOverlay,'MapOverlay':ArcGISMapOverlay,'MapType':ArcGISMapType};var Y=S('google.maputils');Y.arcgis=bp;if(window.GMap2){for(var x in bp){if(bp.hasOwnProperty(x)){window['ArcGIS'+x]=bp[x]}}}})();